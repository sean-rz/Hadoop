{"paragraphs":[{"text":"%md\n### Let's make sure Spark is working!\nLet's see which which we are working with","dateUpdated":"2019-03-11T02:50:38+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Let's make sure Spark is working!</h3>\n<p>Let's see which which we are working with</p>\n"}]},"apps":[],"jobName":"paragraph_1552272638758_1188980137","id":"20190310-181740_1162345545","dateCreated":"2019-03-11T02:50:38+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:245"},{"text":"sc.version","dateUpdated":"2019-03-11T16:39:55+0000","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res4: String = 2.3.0.2.6.5.0-292\n"}]},"apps":[],"jobName":"paragraph_1552272638760_1186671643","id":"20190310-182112_1862818720","dateCreated":"2019-03-11T02:50:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:246","user":"anonymous","dateFinished":"2019-03-11T16:39:58+0000","dateStarted":"2019-03-11T16:39:56+0000"},{"text":"%sh\n\nwget http://media.sundog-soft.com/hadoop/ml-100k/u.data -O /tmp/u.data\nwget http://media.sundog-soft.com/hadoop/ml-100k/u.item -O /tmp/u.item\necho \"Downloaded!\"\n","dateUpdated":"2019-03-11T02:50:38+0000","config":{"colWidth":12,"editorMode":"ace/mode/sh","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"sh"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2019-03-10 18:28:17--  http://media.sundog-soft.com/hadoop/ml-100k/u.data\nResolving media.sundog-soft.com (media.sundog-soft.com)... 52.216.160.251\nConnecting to media.sundog-soft.com (media.sundog-soft.com)|52.216.160.251|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 2079229 (2.0M) [application/octet-stream]\nSaving to: ‘/tmp/u.data’\n\n     0K .......... .......... .......... .......... ..........  2%  542K 4s\n    50K .......... .......... .......... .......... ..........  4% 1.31M 3s\n   100K .......... .......... .......... .......... ..........  7% 1.63M 2s\n   150K .......... .......... .......... .......... ..........  9% 3.37M 2s\n   200K .......... .......... .......... .......... .......... 12% 3.06M 1s\n   250K .......... .......... .......... .......... .......... 14% 1.90M 1s\n   300K .......... .......... .......... .......... .......... 17% 2.53M 1s\n   350K .......... .......... .......... .......... .......... 19% 1.58M 1s\n   400K .......... .......... .......... .......... .......... 22% 13.4M 1s\n   450K .......... .......... .......... .......... .......... 24% 2.92M 1s\n   500K .......... .......... .......... .......... .......... 27% 1.79M 1s\n   550K .......... .......... .......... .......... .......... 29% 4.72M 1s\n   600K .......... .......... .......... .......... .......... 32% 5.08M 1s\n   650K .......... .......... .......... .......... .......... 34% 4.32M 1s\n   700K .......... .......... .......... .......... .......... 36% 5.01M 1s\n   750K .......... .......... .......... .......... .......... 39% 3.72M 1s\n   800K .......... .......... .......... .......... .......... 41% 3.89M 1s\n   850K .......... .......... .......... .......... .......... 44% 14.2M 0s\n   900K .......... .......... .......... .......... .......... 46% 2.43M 0s\n   950K .......... .......... .......... .......... .......... 49% 6.49M 0s\n  1000K .......... .......... .......... .......... .......... 51% 6.15M 0s\n  1050K .......... .......... .......... .......... .......... 54% 4.26M 0s\n  1100K .......... .......... .......... .......... .......... 56% 5.46M 0s\n  1150K .......... .......... .......... .......... .......... 59% 1.96M 0s\n  1200K .......... .......... .......... .......... .......... 61% 8.26M 0s\n  1250K .......... .......... .......... .......... .......... 64% 6.37M 0s\n  1300K .......... .......... .......... .......... .......... 66% 4.95M 0s\n  1350K .......... .......... .......... .......... .......... 68% 4.27M 0s\n  1400K .......... .......... .......... .......... .......... 71% 8.37M 0s\n  1450K .......... .......... .......... .......... .......... 73% 3.62M 0s\n  1500K .......... .......... .......... .......... .......... 76% 4.54M 0s\n  1550K .......... .......... .......... .......... .......... 78% 6.03M 0s\n  1600K .......... .......... .......... .......... .......... 81% 5.70M 0s\n  1650K .......... .......... .......... .......... .......... 83% 6.67M 0s\n  1700K .......... .......... .......... .......... .......... 86% 4.98M 0s\n  1750K .......... .......... .......... .......... .......... 88% 5.23M 0s\n  1800K .......... .......... .......... .......... .......... 91% 2.90M 0s\n  1850K .......... .......... .......... .......... .......... 93% 3.57M 0s\n  1900K .......... .......... .......... .......... .......... 96% 10.4M 0s\n  1950K .......... .......... .......... .......... .......... 98% 6.10M 0s\n  2000K .......... .......... ..........                      100% 6.22M=0.6s\n\n2019-03-10 18:28:19 (3.19 MB/s) - ‘/tmp/u.data’ saved [2079229/2079229]\n\n--2019-03-10 18:28:19--  http://media.sundog-soft.com/hadoop/ml-100k/u.item\nResolving media.sundog-soft.com (media.sundog-soft.com)... 52.217.2.4\nConnecting to media.sundog-soft.com (media.sundog-soft.com)|52.217.2.4|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 236344 (231K) [application/octet-stream]\nSaving to: ‘/tmp/u.item’\n\n     0K .......... .......... .......... .......... .......... 21%  619K 0s\n    50K .......... .......... .......... .......... .......... 43% 1.15M 0s\n   100K .......... .......... .......... .......... .......... 64% 2.21M 0s\n   150K .......... .......... .......... .......... .......... 86%  118M 0s\n   200K .......... .......... ..........                      100% 1.13M=0.2s\n\n2019-03-10 18:28:19 (1.31 MB/s) - ‘/tmp/u.item’ saved [236344/236344]\n\nDownloaded!\n"}]},"apps":[],"jobName":"paragraph_1552272638761_1186286894","id":"20190310-182314_324664400","dateCreated":"2019-03-11T02:50:38+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:247"},{"title":"Copy data to HDFS","text":"%sh\n\nhadoop fs -rm -r -f /tmp/ml-100k\nhadoop fs -mkdir /tmp/ml-100k\n\nhadoop fs -put /tmp/u.data /tmp/ml-100k/\nhadoop fs -put /tmp/u.item /tmp/ml-100k/\n","dateUpdated":"2019-03-11T02:50:38+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sh","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1552272638763_1187056392","id":"20190310-182814_505382325","dateCreated":"2019-03-11T02:50:38+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:248"},{"text":"final case class Rating(movieID:Int, rating:Int)\nval lines = sc.textFile(\"hdfs:///tmp/ml-100k/u.data\").map(x => {val fields = x.split(\"\\t\"); Rating(fields(1).toInt, fields(2).toInt)})","dateUpdated":"2019-03-11T16:47:43+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one unchecked warning; re-run with -unchecked for details\ndefined class Rating\nlines: org.apache.spark.rdd.RDD[Rating] = MapPartitionsRDD[22] at map at <console>:32\n"}]},"apps":[],"jobName":"paragraph_1552272638764_1185132648","id":"20190310-183643_1680198353","dateCreated":"2019-03-11T02:50:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:249","user":"anonymous","dateFinished":"2019-03-11T16:47:46+0000","dateStarted":"2019-03-11T16:47:44+0000"},{"text":"import sqlContext.implicits._\nval ratingsDF = lines.toDF()\n\nratingsDF.printSchema()\n","dateUpdated":"2019-03-11T16:49:04+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import sqlContext.implicits._\nratingsDF: org.apache.spark.sql.DataFrame = [movieID: int, rating: int]\nroot\n |-- movieID: integer (nullable = false)\n |-- rating: integer (nullable = false)\n\n"}]},"apps":[],"jobName":"paragraph_1552272638765_1184747899","id":"20190310-184515_2041815774","dateCreated":"2019-03-11T02:50:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:250","user":"anonymous","dateFinished":"2019-03-11T16:49:14+0000","dateStarted":"2019-03-11T16:49:05+0000"},{"text":"val topMovieIDs = ratingsDF.groupBy(\"movieID\").count().orderBy(desc(\"count\")).cache()\ntopMovieIDs.show()","dateUpdated":"2019-03-11T16:50:30+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"topMovieIDs: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [movieID: int, count: bigint]\n+-------+-----+\n|movieID|count|\n+-------+-----+\n|     50|  584|\n|    258|  509|\n|    100|  508|\n|    181|  507|\n|    294|  485|\n|    286|  481|\n|    288|  478|\n|      1|  452|\n|    300|  431|\n|    121|  429|\n|    174|  420|\n|    127|  413|\n|     56|  394|\n|      7|  392|\n|     98|  390|\n|    237|  384|\n|    117|  378|\n|    172|  368|\n|    222|  365|\n|    204|  350|\n+-------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1552272638766_1185902146","id":"20190310-184844_2024239745","dateCreated":"2019-03-11T02:50:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:251","user":"anonymous","dateFinished":"2019-03-11T16:50:51+0000","dateStarted":"2019-03-11T16:50:31+0000"},{"dateUpdated":"2019-03-11T16:56:15+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552272638767_1185517397","id":"20190310-185320_350619017","dateCreated":"2019-03-11T02:50:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:252","text":"ratingsDF.registerTempTable(\"ratings\")\n","user":"anonymous","dateFinished":"2019-03-11T16:56:16+0000","dateStarted":"2019-03-11T16:56:15+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552323348914_1374914399","id":"20190311-165548_894370721","dateCreated":"2019-03-11T16:55:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:761","text":"%sql\n\nSELECT * FROM ratings LIMIT 10","dateUpdated":"2019-03-11T16:57:05+0000","dateFinished":"2019-03-11T16:57:17+0000","dateStarted":"2019-03-11T16:57:06+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"movieID\trating\n50\t5\n172\t5\n133\t1\n242\t3\n302\t3\n377\t1\n51\t2\n346\t1\n474\t4\n265\t2\n"}]}},{"text":"%sql\n\nSELECT rating, COUNT(*) as count FROM ratings GROUP BY rating ","user":"anonymous","dateUpdated":"2019-03-11T17:02:41+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552323425643_-2021356087","id":"20190311-165705_1972925540","dateCreated":"2019-03-11T16:57:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:890","dateFinished":"2019-03-11T17:02:19+0000","dateStarted":"2019-03-11T17:02:12+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"rating\tcount\n1\t6111\n3\t27145\n5\t21203\n4\t34174\n2\t11370\n"}]}},{"text":"final case class Movie(movieID: Int, title: String)\nval lines = sc.textFile(\"hdfs:///tmp/ml-100k/u.item\").map(x => {val fields = x.split('|'); Movie(fields(0).toInt, fields(1))})\n\nimport sqlContext.implicits._\nval moviesDF = lines.toDF()\nmoviesDF.show()","user":"anonymous","dateUpdated":"2019-03-11T17:10:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552323732308_-139910419","id":"20190311-170212_2103774974","dateCreated":"2019-03-11T17:02:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1042","dateFinished":"2019-03-11T17:11:07+0000","dateStarted":"2019-03-11T17:10:58+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one unchecked warning; re-run with -unchecked for details\ndefined class Movie\nlines: org.apache.spark.rdd.RDD[Movie] = MapPartitionsRDD[56] at map at <console>:35\nimport sqlContext.implicits._\nmoviesDF: org.apache.spark.sql.DataFrame = [movieID: int, title: string]\n+-------+--------------------+\n|movieID|               title|\n+-------+--------------------+\n|      1|    Toy Story (1995)|\n|      2|    GoldenEye (1995)|\n|      3|   Four Rooms (1995)|\n|      4|   Get Shorty (1995)|\n|      5|      Copycat (1995)|\n|      6|Shanghai Triad (Y...|\n|      7|Twelve Monkeys (1...|\n|      8|         Babe (1995)|\n|      9|Dead Man Walking ...|\n|     10|  Richard III (1995)|\n|     11|Seven (Se7en) (1995)|\n|     12|Usual Suspects, T...|\n|     13|Mighty Aphrodite ...|\n|     14|  Postino, Il (1994)|\n|     15|Mr. Holland's Opu...|\n|     16|French Twist (Gaz...|\n|     17|From Dusk Till Da...|\n|     18|White Balloon, Th...|\n|     19|Antonia's Line (1...|\n|     20|Angels and Insect...|\n+-------+--------------------+\nonly showing top 20 rows\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552324199114_1501920407","id":"20190311-170959_1947786678","dateCreated":"2019-03-11T17:09:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1342","text":"moviesDF.registerTempTable(\"titles\")","dateUpdated":"2019-03-11T17:12:16+0000","dateFinished":"2019-03-11T17:12:17+0000","dateStarted":"2019-03-11T17:12:16+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552324336759_-1645958820","id":"20190311-171216_1258124453","dateCreated":"2019-03-11T17:12:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1464","text":"%sql\n\nSELECT t.title, count(*) cnt FROM ratings r JOIN titles t ON r.movieID = t.movieID GROUP BY t.title ORDER BY cnt DESC LIMIT 20","dateUpdated":"2019-03-11T17:19:39+0000","dateFinished":"2019-03-11T17:19:57+0000","dateStarted":"2019-03-11T17:19:39+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"title\tcnt\nStar Wars (1977)\t584\nContact (1997)\t509\nFargo (1996)\t508\nReturn of the Jedi (1983)\t507\nLiar Liar (1997)\t485\nEnglish Patient, The (1996)\t481\nScream (1996)\t478\nToy Story (1995)\t452\nAir Force One (1997)\t431\nIndependence Day (ID4) (1996)\t429\nRaiders of the Lost Ark (1981)\t420\nGodfather, The (1972)\t413\nPulp Fiction (1994)\t394\nTwelve Monkeys (1995)\t392\nSilence of the Lambs, The (1991)\t390\nJerry Maguire (1996)\t384\nChasing Amy (1997)\t379\nRock, The (1996)\t378\nEmpire Strikes Back, The (1980)\t368\nStar Trek: First Contact (1996)\t365\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552324582990_-1329170390","id":"20190311-171622_1518327045","dateCreated":"2019-03-11T17:16:22+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1557"}],"name":"Playing with MovieLens","id":"2E89KY9UH","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}